<section *ngIf="isThemeLoaded" [ngClass]="{'toggle-sidebar' : sidebarToggle}" [ngStyle]="{ 'background-color' : getPrimaryColor() }">
  <header id="header" class="header fixed-top d-flex align-items-center" *ngIf="hasAuth()" [ngStyle]="{ 'background-color' : getPrimaryColor() }">
    <div class="d-flex align-items-center justify-content-between">
      <span class="logo d-flex align-items-center">
        <span class="d-none d-lg-block" [ngStyle]="{ 'color' : getTitleColor() }">{{ getAppTitle() }}</span>
      </span>
      <i class="bi bi-list toggle-sidebar-btn" [ngStyle]="{ 'color' : getTitleColor() }" (click)="sidebarToggle = !sidebarToggle"></i>
    </div>
  </header>

  <aside id="sidebar" class="sidebar" *ngIf="hasAuth()" [ngStyle]="{ 'background-color' : getPrimaryColor() }">
    <ul class="sidebar-nav" id="sidebar-nav">
      <li class="nav-item">
        <a [ngClass]="{
          'nav-link collapsed' : true,
          'active' : currentRoute === '/app'
        }" routerLink="/app">
          <i class="bi bi-grid"></i>
          <span>Dashboard</span>
        </a>
      </li>
      <li class="nav-item">
        <a [ngClass]="{
          'nav-link collapsed' : true,
          'active' : currentRoute === '/app/research-capsules'
        }" routerLink="/app/research-capsules">
          <i class="bi bi-menu-button-wide"></i>
          <span>Research Capsules</span>
        </a>
      </li>
      <li class="nav-item" *ngIf="AuthRole() === 'admin'">
        <a [ngClass]="{
          'nav-link collapsed' : true,
          'active' : currentRoute === '/app/accounts'
        }" routerLink="/app/accounts">
          <i class="bi bi-people"></i>
          <span>Accounts Management</span>
        </a>
      </li>
      <li class="nav-item" *ngIf="AuthRole() === 'admin'">
        <a [ngClass]="{
          'nav-link collapsed' : true,
          'active' : currentRoute === '/app/content-management'
        }" routerLink="/app/content-management">
          <i class="bi bi-aspect-ratio"></i>
          <span>Content Management</span>
        </a>
      </li>
      <li class="nav-item">
        <a [ngClass]="{
          'nav-link collapsed' : true,
          'active' : currentRoute === '/app/profile'
        }" routerLink="/app/profile">
          <i class="bi bi-person"></i>
          <span>Profile</span>
        </a>
      </li>
      <li class="nav-item" *ngIf="AuthRole() === 'admin'">
        <a [ngClass]="{
          'nav-link collapsed' : true,
          'active' : currentRoute === '/app/reports'
        }" routerLink="/app/reports">
          <i class="bi bi-file-earmark"></i>
          <span>Reports</span>
        </a>
      </li>
      <li class="nav-item">
        <button class="btn btn-outline-danger w-100" (click)="signOut()">Sign out</button>
      </li>
    </ul>
  </aside>

  <main [id]="hasAuth() ? 'main' : ''" [ngClass]="{'main' : hasAuth()}" [ngStyle]="{ 'background-color' : getBodyBackgroundColor() }">
    <div class="position-sticky top-0 w-100 d-flex justify-content-center align-items-center"
      style="height:80vh; z-index: 100;" *ngIf="isPageLoading">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    <div [@routerAnim]="prepareRoute(outlet)">
      <router-outlet #outlet="outlet"></router-outlet>
    </div>
  </main>
</section>
<div *ngIf="!isThemeLoaded" class="bg-white w-100 d-flex justify-content-center align-items-center position-fixed top-0 start-0" style="height: 100%;z-index:500">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>